/* style.css */
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
    display: flex;
    flex-direction: column;
    height: 100vh; /* Занимаем всю высоту */
    overflow: hidden; /* Предотвращаем прокрутку body */
    position: relative; /* Для позиционирования */
}

.container {
    padding: 15px;
    display: flex;
    flex-direction: column;
    flex-grow: 1; /* Контейнер растягивается */
    overflow: hidden; /* Предотвращаем прокрутку контейнера */
    position: relative; /* Для drag-overlay */
}

header {
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid #ccc;
}

header h1 {
    margin: 0 0 10px 0;
}

.folder-selection {
    display: flex;
    align-items: center; /* Выравниваем элементы по вертикали */
    gap: 10px; /* Пространство между кнопкой и индикатором/инфо */
    flex-wrap: wrap; /* Разрешаем перенос, если не влезает */
}

#status-bar {
    margin-top: 8px;
    font-size: 0.9em;
    color: #555;
    min-height: 1.2em;
    word-break: break-all; /* Перенос длинных путей */
}

#last-folder-info {
    font-size: 0.8em;
    color: #666;
    display: inline-flex; /* Чтобы кнопка была рядом */
    align-items: center;
}
#last-folder-info button {
    font-size: 0.9em; /* Кнопка "Загрузить" чуть меньше */
    padding: 2px 5px;
    margin-left: 5px;
}


.content-area {
    display: flex;
    flex-grow: 1; /* Занимает оставшееся место */
    overflow: hidden; /* Важно для прокрутки панелей */
    gap: 15px; /* Пространство между панелями */
}

.panel {
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 4px;
    padding: 15px;
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Панель не должна выходить за рамки */
}

.file-tree-panel {
    flex-basis: 40%; /* Начальная ширина левой панели */
    min-width: 250px;
    position: relative; /* Для позиционирования .tree-controls */
}

.output-panel {
    flex-basis: 60%; /* Начальная ширина правой панели */
    min-width: 300px;
    display: flex; /* Делаем панель flex-контейнером */
    flex-direction: column; /* Секции идут друг под другом */
    gap: 15px; /* Пространство между секциями */
}

/* Общие стили для секций внутри правой панели */
.output-section {
    display: flex;
    flex-direction: column;
    /* flex-grow: 1; Убрали, т.к. высота будет разной */
    min-height: 0; /* Важно для flex-shrink */
    /* margin-bottom: 15px; Заменено на gap в output-panel */
}
/* Убрали :last-child margin-bottom */


.panel h2 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 1.1em;
    border-bottom: 1px solid #eee;
    padding-bottom: 5px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    flex-shrink: 0; /* Заголовок не должен сжиматься */
}

/* Стили для элементов управления деревом */
.tree-controls {
    display: flex;
    gap: 5px;
    margin-bottom: 10px;
    padding: 5px;
    background-color: #f0f0f0;
    border-radius: 3px;
    flex-wrap: wrap;
}

#search-input {
    flex-grow: 1;
    padding: 4px 8px;
    border: 1px solid #ccc;
    border-radius: 3px;
    font-size: 0.9em;
    min-width: 100px;
}

.tree-controls button {
    padding: 4px 8px;
    font-size: 0.85em;
    background-color: #e0e0e0;
}
.tree-controls button:hover:not(:disabled) {
    background-color: #d0d0d0;
}


#file-tree-container {
    flex-grow: 1;
    overflow-y: auto;
    font-size: 0.9em;
    border: 1px solid #eee;
    padding: 5px;
}

/* Стили для дерева файлов */
#file-tree-container ul {
    list-style-type: none;
    padding-left: 20px;
    margin: 0;
}
#file-tree-container ul.collapsed {
    display: none;
}

#file-tree-container li {
    margin: 1px 0;
    padding: 1px 3px;
    white-space: nowrap;
    border-radius: 2px;
    transition: background-color 0.2s ease;
}

#file-tree-container li.hidden-node {
    display: none;
}

#file-tree-container li.search-match > label {
    box-shadow: inset 0 0 0 2px #ffd700;
    background-color: transparent;
}


#file-tree-container label {
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    position: relative;
    width: 100%;
    padding: 1px 0;
}

#file-tree-container input[type="checkbox"] {
    margin-right: 5px;
    flex-shrink: 0;
}

.item-label span.node-name {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    display: inline-block;
    vertical-align: middle;
}

.item-label::before {
    content: '';
    display: inline-block;
    width: 1em;
    height: 1em;
    margin-right: 4px;
    background-repeat: no-repeat;
    background-position: center center;
    background-size: contain;
    vertical-align: middle;
    flex-shrink: 0;
}

.item-label.is-directory::before {
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M.577 3.25a.75.75 0 0 1 .5-.75h4.44l1.25-1.5a.75.75 0 0 1 .6-.3h5.133a.75.75 0 0 1 .75.75v1.196l.001.001a1.75 1.75 0 0 1 1.699 1.71l-.006 7.039a1.75 1.75 0 0 1-1.75 1.75H2.25a1.75 1.75 0 0 1-1.75-1.75V3.25Zm7.5 1a.75.75 0 0 0-.75.75v.25h7.147A.25.25 0 0 0 15 5V3.25a.25.25 0 0 0-.25-.25H8.077Z"/></svg>');
}
.item-label:not(.is-directory)::before {
     background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M3.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25V6.19l-4.44-4.44H3.75Zm8.5 5.44V13.5h-8.5V1.75h4.19v4.19c0 .138.112.25.25.25h4.06Z"/></svg>');
}

.item-label.is-ignored {
    color: #888;
    font-style: italic;
}
.item-label.is-ignored::before {
    opacity: 0.6;
}
#file-tree-container li:has(> label.is-ignored) {
     background-color: #f8f8f8;
}


.item-label.has-error {
     color: #d32f2f;
}
.item-label.has-error::before {
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path fill-rule="evenodd" d="M8 1.5a6.5 6.5 0 1 0 0 13 6.5 6.5 0 0 0 0-13ZM0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8Zm11.354 2.646a.5.5 0 0 1 0 .708l-.708.707a.5.5 0 0 1-.707 0L8 9.707l-1.94 1.94a.5.5 0 0 1-.707 0l-.708-.707a.5.5 0 0 1 0-.708L6.293 9 4.354 7.06a.5.5 0 0 1 0-.707l.707-.707a.5.5 0 0 1 .707 0L8 7.586l1.94-1.94a.5.5 0 0 1 .707 0l.708.707a.5.5 0 0 1 0 .707L9.707 9l1.647 1.646Z" clip-rule="evenodd"/></svg>');
}
#file-tree-container li:has(> label.has-error) {
     background-color: #ffebee;
}

/* --- ВОЗВРАЩЕНЫ СТИЛИ для структуры --- */
.structure-section {
    /* Можно добавить специфичные стили, но пока наследуем от .output-section */
    /* ПРОГНОЗ: Зададим высоту и возможность изменения размера */
    flex-shrink: 0; /* Секция структуры не должна сильно сжиматься */
    /* Можно задать начальную высоту, например: */
    /* height: 200px; */
}

.structure-section textarea {
    width: calc(100% - 10px); /* Учитываем padding/border */
    min-height: 100px; /* Минимальная высота */
    flex-grow: 1; /* Растягиваем по доступной высоте секции */
    margin-bottom: 10px;
    font-family: "Courier New", Courier, monospace;
    font-size: 0.85em;
    border: 1px solid #ccc;
    padding: 5px;
    resize: vertical; /* Позволяем изменять высоту */
}

/* --- СТИЛИ для области перетаскивания --- */
.draggable-section {
    flex-grow: 1; /* Эта секция будет занимать оставшееся место */
    /* min-height уже 0 от .output-section */
}

#draggable-files-container {
    flex-grow: 1; /* Занимает доступное место внутри draggable-section */
    border: 1px solid #eee;
    padding: 10px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 5px;
    background-color: #fdfdfd; /* Чуть другой фон для визуального отличия */
}

#draggable-files-container .placeholder-text {
    color: #888;
    font-style: italic;
    text-align: center;
    margin: auto;
}

.draggable-file-item {
    padding: 8px 12px;
    background-color: #f0f0f0; /* Сделаем чуть темнее фона контейнера */
    border: 1px solid #ddd;
    border-radius: 4px;
    cursor: grab;
    user-select: none;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9em;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.draggable-file-item:active {
    cursor: grabbing;
    background-color: #e0e0e0;
}

.draggable-file-item::before {
    content: '';
    display: inline-block;
    width: 1em;
    height: 1em;
    background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" fill="currentColor"><path d="M3.75 1.5a.25.25 0 0 0-.25.25v11.5c0 .138.112.25.25.25h8.5a.25.25 0 0 0 .25-.25V6.19l-4.44-4.44H3.75Zm8.5 5.44V13.5h-8.5V1.75h4.19v4.19c0 .138.112.25.25.25h4.06Z"/></svg>');
    background-repeat: no-repeat;
    background-position: center center;
    background-size: contain;
    vertical-align: middle;
    flex-shrink: 0;
    opacity: 0.8;
}

/* Общие стили кнопок */
button {
    padding: 8px 15px;
    cursor: pointer;
    border: 1px solid #ccc;
    background-color: #e7e7e7;
    border-radius: 3px;
    transition: background-color 0.2s ease;
    white-space: nowrap;
    flex-shrink: 0; /* Кнопки не должны сжиматься */
}

button:disabled {
    cursor: not-allowed;
    opacity: 0.6;
}

button:hover:not(:disabled) {
    background-color: #ddd;
}

/* Стили для индикаторов загрузки (оставлен только общий .loading-indicator) */
.loading-indicator {
    font-size: 0.85em;
    color: #333;
    display: inline-flex;
    align-items: center;
}

.loading-indicator::before { /* Простой CSS спиннер */
    content: "";
    display: inline-block;
    width: 1em;
    height: 1em;
    margin-right: 5px;
    border: 2px solid #f3f3f3;
    border-top: 2px solid #555;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    flex-shrink: 0; /* Спиннер не должен сжиматься */
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Стили для оверлея Drag & Drop папки (если вдруг понадобится) */
#drag-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    display: none; /* Скрыт по умолчанию */
    justify-content: center;
    align-items: center;
    font-size: 1.5em;
    text-align: center;
    z-index: 10;
    pointer-events: none;
    border: 3px dashed #fff;
    border-radius: 5px;
}

#drag-overlay p {
    padding: 20px;
    background-color: rgba(0, 0, 0, 0.7);
    border-radius: 5px;
}